[Documentation](../../../../index.md)/[Standards](../../../index.md)/
[Security](../../index.md)/[OWASP](../index.md)/[2021](index.md)/A10:2021 – Server-Side Request Forgery (SSRF)

[Normative documentation](https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/)

# A10:2021 – Server-Side Request Forgery (SSRF)

## Overview

This category is added from the Top 10 community survey (#1). The data shows a relatively low incidence rate 
with above average testing coverage and above-average Exploit and Impact potential ratings. As new entries are 
likely to be a single or small cluster of Common Weakness Enumerations (CWEs) for attention and awareness, the 
hope is that they are subject to focus and can be rolled into a larger category in a future edition.

# Description

SSRF flaws occur whenever a web application is fetching a remote resource without validating the user-supplied URL. 
It allows an attacker to coerce the application to send a crafted request to an unexpected destination, even when 
protected by a firewall, VPN, or another type of network access control list (ACL).

As modern web applications provide end-users with convenient features, fetching a URL becomes a common scenario. 
As a result, the incidence of SSRF is increasing. Also, the severity of SSRF is becoming higher due to cloud services 
and the complexity of architectures.

## How to Prevent

Developers can prevent SSRF by implementing some or all the following defense in depth controls:

### From Network layer

|Mitigation|Solution|DEV|OPS|NIS|eVZP|
|----------|--------|---|---|---|---|----|
|Segment remote resource access functionality in separate networks to reduce the impact of SSRF|Follow recommendation in network design|NO|NO|task-or-NOA|task-or-NOA|
|Enforce “deny by default” firewall policies or network access control rules to block all but essential intranet traffic.|Implement recommendation|NO|NO|task-or-NOA|task-or-NOA|

### From Application layer

|Mitigation|Solution|DEV|OPS|NIS|eVZP|
|----------|--------|---|---|---|----|
|Sanitize and validate all client-supplied input data|Apply|YES|NO|task-or-NOA|task-or-NOA|
|Enforce the URL schema, port, and destination with a positive allow list|Apply|YES|NO|task-or-NOA|task-or-NOA|
|Do not send raw responses to clients|Apply|YES|NO|task-or-NOA|task-or-NOA|
|Disable HTTP redirections|Apply|YES|NO|task-or-NOA|task-or-NOA|
|Be aware of the URL consistency to avoid attacks such as DNS rebinding and “time of check, time of use” (TOCTOU) race conditions|Unclear, discussion needed|NO|NO|NO|Not applicable|Not applicable|

Do not mitigate SSRF via the use of a deny list or regular expression. Attackers have payload lists, tools, and skills 
to bypass deny lists.